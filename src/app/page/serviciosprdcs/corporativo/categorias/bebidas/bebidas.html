<div class="container mt-5">
  <header class="text-center mb-5">
    <h1 class="titulo-seccion">ü•§ Bebidas Deliciosas</h1>
    <p class="descripcion-seccion">Hidrataci√≥n y sabor para acompa√±ar tus amasijos</p>
  </header>

  <!-- Productos Grid -->
  <div class="row g-4">
    
    <div class="col-12 col-md-6 col-lg-4" *ngFor="let producto of productos">
      <div class="card-glass producto-card">

        <img 
          [src]="producto.imagen" 
          [alt]="producto.nombre" 
          class="producto-img"
        >

        <div class="producto-info">

          <h5 class="producto-nombre">{{producto.nombre}}</h5>
          <p class="producto-desc">{{producto.descripcion}}</p>

          <!-- PRODUCTOS NORMALES -->
          <div *ngIf="!producto.tieneCatalogo">

            <label class="label">Cantidad:</label>
            <select class="input-select"
              [(ngModel)]="producto.opcionCantidad"
              (change)="onOpcionCantidadChange(producto)">
              <option value="1">1 unidad</option>
              <option value="12">12 unidades</option>
              <option value="24">24 unidades</option>
              <option value="personalizada">Cantidad personalizada</option>
            </select>

            <input *ngIf="producto.opcionCantidad === 'personalizada'"
              type="number"
              class="input-number"
              [(ngModel)]="producto.cantidadPersonalizada"
              (input)="onCantidadPersonalizadaChange(producto)"
              placeholder="Cantidad" min="1">

            <span class="total-precio">
              Total: ${{getPrecioTotal(producto).toLocaleString()}}
            </span>

            <button class="btn-primary"
              (click)="agregarAlCarrito(producto)">
              Agregar al Pedido
            </button>

          </div>

          <!-- PRODUCTOS CON CAT√ÅLOGO -->
          <div *ngIf="producto.tieneCatalogo">

            <label class="label">Selecciona una opci√≥n:</label>
            <select class="input-select"
              [(ngModel)]="producto.opcionSeleccionadaId"
              (change)="onOpcionSeleccionadaChange(producto)">
              <option value="">-- Elegir opci√≥n --</option>
              <option
                *ngFor="let opcion of getCatalogoOpciones(producto.catalogoId!)"
                [value]="opcion.id">
                {{opcion.nombre}} - ${{opcion.precio.toLocaleString()}}
              </option>
            </select>

            <label class="label">Cantidad:</label>
            <select class="input-select"
              [(ngModel)]="producto.opcionCantidad"
              (change)="onOpcionCantidadChange(producto)">
              <option value="30">30 unidades</option>
              <option value="50">50 unidades</option>
              <option value="100">100 unidades</option>
              <option value="200">200 unidades</option>
              <option value="personalizada">Cantidad personalizada</option>
            </select>

            <input *ngIf="producto.opcionCantidad === 'personalizada'"
              type="number"
              class="input-number"
              [(ngModel)]="producto.cantidadPersonalizada"
              (input)="onCantidadPersonalizadaChange(producto)"
              placeholder="Cantidad" min="1">

            <span *ngIf="producto.opcionSeleccionada"
              class="total-precio">
              Total: ${{getPrecioTotalCatalogo(producto).toLocaleString()}}
            </span>

            <button class="btn-primary"
              *ngIf="producto.opcionSeleccionada"
              (click)="agregarCatalogoAlCarrito(producto)">
              Agregar al Pedido
            </button>

          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Carrito -->
  <div class="card-glass carrito mt-5" *ngIf="carrito.length > 0">
    <h5 class="mb-3">üõí Resumen del Pedido</h5>

    <div *ngFor="let item of carrito; let i = index" class="carrito-item">
      <div>
        <strong>{{item.nombre}}</strong><br>
        <small>{{item.cantidad}} uds x ${{item.precioUnitario.toLocaleString()}}</small>
        <button class="btn-eliminar" (click)="removerDelCarrito(i)">√ó</button>
      </div>
      <span class="carrito-total">
        ${{item.precioTotal.toLocaleString()}}
      </span>
    </div>

    <div class="carrito-footer">
      <strong>Total:</strong>
      <strong class="total-precio">
        ${{getTotalCarrito().toLocaleString()}}
      </strong>
    </div>
  </div>

  <div class="text-center mt-5">
    <button routerLink="/servicio/corporativo" class="btn-primary">
      ‚Üê Volver
    </button>
  </div>
</div>
